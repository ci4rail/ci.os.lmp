# Every file needs to contain a header, that provides kas with information
# about the context of this file.
header:
  # The `version` entry in the header describes for which configuration
  # format version this file was created for. It is used by kas to figure
  # out if it is compatible with this file. The version is an integer that
  # is increased on every format change.
  version: 9
# The machine as it is written into the `local.conf` of bitbake.
machine: verdin-imx8mm
# The distro name as it is written into the `local.conf` of bitbake.
distro: tdx-xwayland
repos:
  #
  # The layer revisions were taken from https://git.toradex.com/cgit/toradex-manifest.git/ 
  # tag 5.0.0
  # file "tdxdef/default.xml"
  #

  # from txd: https://git.toradex.com/cgit/toradex-manifest.git/tree/base/pinned.xml?h=dunfell-5.x.y
  #
  src/bitbake:
    url: "https://github.com/openembedded/bitbake.git"
    refspec: "1.46"
    layers:
      # bitbake is no layer. Exclude it from bblayers.conf
      bitbake: "no"
  
  src/meta-openembedded:
    url: "https://github.com/openembedded/meta-openembedded.git"
    refspec: dunfell
    layers:
      meta-oe:
      meta-networking:
      meta-filesystems:
      meta-python:
      meta-xfce:
      meta-gnome:
      meta-multimedia:

  src/meta-yocto:
    url: "https://git.yoctoproject.org/git/meta-yocto.git"
    refspec: dunfell
    layers:
      meta-poky:

  src/openembedded-core:
    url: "https://github.com/openembedded/openembedded-core.git"
    refspec: dunfell
    layers:
      meta:

  # from tdx: https://git.toradex.com/cgit/toradex-manifest.git/tree/bsp/pinned-nxp.xml?h=dunfell-5.x.y
  src/meta-freescale-3rdparty.git:
    url: "https://github.com/Freescale/meta-freescale-3rdparty.git"
    refspec: 83644f2ea000c1ab92fc0da1c45e2d7fb7a6060c

  src/meta-freescale-distro:
    url: "https://github.com/Freescale/meta-freescale-distro.git"
    refspec: a1821b36af7bba4f6628e4244df7fc9a038d0f34
  
  src/meta-freescale:
    url: "https://github.com/Freescale/meta-freescale.git"
    refspec: bb582837c8c1ee08255b721f0bf946d6074c4773

  # from tdx: https://git.toradex.com/cgit/toradex-manifest.git/tree/bsp/pinned-tdx.xml?h=dunfell-5.x.y
  src/meta-toradex-bsp-common:
    url: "https://git.toradex.com/meta-toradex-bsp-common.git"
    refspec: 51927b354280c398b11b7b6bd64c1617825f17d1

  src/meta-toradex-nxp:
    url: "https://git.toradex.com/meta-toradex-nxp.git"
    refspec: fddb6cc10a1df717cc77b6958ce5e233cef9a80a

  src/meta-toradex-tegra:
    url: "https://git.toradex.com/meta-toradex-tegra.git"
    refspec: 962b01390fdc261b5f86921231792daa8f6af043

  # from tdx: https://git.toradex.com/cgit/toradex-manifest.git/tree/tdxref/default.xml?h=dunfell-5.x.y
  src/meta-qt5:
    url: "https://github.com/meta-qt5/meta-qt5.git"
    refspec: 0e7015f7a86dda995a39662edbb5c26da647c496

  src/meta-toradex-demos:
    url: "https://git.toradex.com/meta-toradex-demos.git"
    refspec: 93c179932a1a282bb56823ee202e387ced41f388

  src/meta-toradex-distro:
    url: "https://git.toradex.com/meta-toradex-distro.git"
    refspec: 1e0d10b2851ac455618ab7e4c7db86c9ad1227a0

  # mender, from: https://raw.githubusercontent.com/mendersoftware/meta-mender-community/dunfell/scripts/mender-no-setup-layers.xml
  src/meta-mender:
    url: "https://github.com/mendersoftware/meta-mender"
    refspec: dunfell
    layers:
      meta-mender-core:
      meta-mender-demo:

  src/meta-mender-community:
    url: "https://github.com/mendersoftware/meta-mender-community"
    refspec: dunfell
    layers:
      meta-mender-toradex-nxp:

bblayers_conf_header:
  src/meta-custom: |
    BBPATH = "${TOPDIR}"
    BBFILES ?= ""

env:
  MENDER_ARTIFACT_NAME: "release"
  MENDER_SERVER_URL: "https://hosted.mender.io"
  MENDER_TENANT_TOKEN: ""

local_conf_header:
  src/meta-custom: |
    DL_DIR ?= "/downloads"
    SSTATE_DIR ?= "/sstate-cache"
    DEPLOY_DIR = "/install"
    EXTRA_IMAGE_FEATURES ?= "debug-tweaks package-management"
    USER_CLASSES ?= "buildstats image-mklibs image-prelink"
    PATCHRESOLVE = "noop"
    PACKAGECONFIG_append_pn-qemu-system-native = " sdl"
    PACKAGECONFIG_append_pn-nativesdk-qemu = " sdl"
    CONF_VERSION = "1"
    INHERIT += "rm_work"
    INHERIT += "toradex-mirrors"
    ACCEPT_FSL_EULA = "1"
    DISTRO_FEATURES_remove = "x11 opengl wayland alsa vulkan pulseaudio"
